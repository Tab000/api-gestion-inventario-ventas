### Archivo de pruebas HTTP para VS Code (REST Client extension)
### Instala la extensión "REST Client" en VS Code para usar este archivo

@baseUrlClients = http://localhost:3001
@baseUrlProducts = http://localhost:3002
@baseUrlSales = http://localhost:3003

### ============================================
### 1. VERIFICAR SALUD DE LOS SERVICIOS
### ============================================

### Health Check - Clientes
GET {{baseUrlClients}}/health

### Health Check - Productos
GET {{baseUrlProducts}}/health

### Health Check - Ventas
GET {{baseUrlSales}}/health

### ============================================
### 2. MICROSERVICIO DE CLIENTES
### ============================================

### Crear un cliente
POST {{baseUrlClients}}/clients
Content-Type: application/json

{
  "name": "Juan Pérez",
  "document": "12345678",
  "address": "Calle Principal 123",
  "phone": "555-1234",
  "email": "juan.perez@example.com",
  "observations": "Cliente preferencial"
}

### Obtener todos los clientes
GET {{baseUrlClients}}/clients

### Obtener cliente por ID
GET {{baseUrlClients}}/clients/1

### ============================================
### 3. MICROSERVICIO DE PRODUCTOS
### ============================================

### Crear un producto
POST {{baseUrlProducts}}/products
Content-Type: application/json

{
  "code_sku": "PROD-001",
  "name": "Laptop Dell XPS 15",
  "category": "Electrónica",
  "price_unit": 1500.00,
  "cost_unit": 1000.00,
  "stock_actual": 50,
  "stock_minimo": 10,
  "location": "Almacén A"
}

### Obtener todos los productos
GET {{baseUrlProducts}}/products

### Obtener producto por ID
GET {{baseUrlProducts}}/products/1

### Actualizar stock de un producto (usado internamente por el microservicio de ventas)
PATCH {{baseUrlProducts}}/products/1/stock
Content-Type: application/json

{
  "quantity": 2
}

### ============================================
### 4. MICROSERVICIO DE VENTAS
### ============================================

### Registrar una venta (consulta Clientes y Productos antes de registrar)
POST {{baseUrlSales}}/sales
Content-Type: application/json

{
  "client_id": 1,
  "products": [
    {
      "product_id": 1,
      "quantity": 2
    }
  ]
}

### Obtener todas las ventas
GET {{baseUrlSales}}/sales

### Obtener venta por ID
GET {{baseUrlSales}}/sales/1

### ============================================
### 5. FLUJO COMPLETO DE PRUEBA
### ============================================

### Paso 1: Crear cliente
POST {{baseUrlClients}}/clients
Content-Type: application/json

{
  "name": "María González",
  "document": "87654321",
  "address": "Avenida Central 456",
  "phone": "555-5678",
  "email": "maria.gonzalez@example.com"
}

### Paso 2: Crear producto
POST {{baseUrlProducts}}/products
Content-Type: application/json

{
  "code_sku": "PROD-002",
  "name": "Mouse Inalámbrico Logitech",
  "category": "Accesorios",
  "price_unit": 25.99,
  "cost_unit": 15.00,
  "stock_actual": 100,
  "stock_minimo": 20,
  "location": "Almacén B"
}

### Paso 3: Registrar venta (consulta ambos microservicios)
POST {{baseUrlSales}}/sales
Content-Type: application/json

{
  "client_id": 1,
  "products": [
    {
      "product_id": 1,
      "quantity": 3
    },
    {
      "product_id": 2,
      "quantity": 5
    }
  ]
}

### Paso 4: Verificar que el stock se actualizó
GET {{baseUrlProducts}}/products/1

### Paso 5: Verificar la venta registrada
GET {{baseUrlSales}}/sales/1

